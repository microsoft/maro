
# add customized units
core:
  units:
    modules:
      - path: "tests.supply_chain.simple_seller"
        definitions:
          # NOTE: do not conflict with built-in ones
          SimpleSellerUnit:
            class: "SimpleSellerUnit"
            datamodel: "SellerDataModel"


train_config: &train
  config:
    patient: 10
    unit_transport_cost: 12

normal_distribution: &normal_distribution
  config:
    train:
      number: 2
      config: *train

facility_definitions:
  SupplierFacility: &supplier_facility
    class: "SupplierFacility"
    children:
      storage:
        class: "StorageUnit"
      distribution:
        class: "DistributionUnit"
    products:
      class: "ProductUnit"
      config:
        consumer:
          class: "ConsumerUnit"
        manufacture:
          class: "ManufactureUnit"

  WarehouseFacility: &warehouse_facility
    class: "WarehouseFacility"
    children:
      storage:
        class: "StorageUnit"
      distribution:
        class: "DistributionUnit"
    products:
      class: "ProductUnit"
      config:
        consumer:
          class: "ConsumerUnit"

  RetailerFacility: &retailer_facility
    class: "RetailerFacility"
    children:
      storage:
        class: "StorageUnit"
    products:
      class: "ProductUnit"
      config:
        consumer:
          class: "ConsumerUnit"
        seller:
          class: "SimpleSellerUnit"
          config:
            sale_hist_len: 4

small_storage: &small_storage
  config:
    capacity: 100
    unit_storage_cost: 1

skus: &sku_definitions
  - id: 1
    name: "sku1"
    output_units_per_lot: 1
    bom:
      sku3: 2

  - id: 2
    name: "sku2"
    output_units_per_lot: 2
    bom:
      sku1: 4

  - id: 3
    name: "sku3"
    output_units_per_lot: 1

  - id: 4
    name: "sku4"
    output_units_per_lot: 2
    bom:
      sku2: 1

world:
  skus: *sku_definitions
  facilities:
    - name: "Supplier_SKU3"
      definition_ref: "SupplierFacility"
      skus:
        sku3:
          init_stock: 80
          has_manufacture: True
          max_manufacture_rate: 50
          manufacture_leading_time: 1
          unit_product_cost: 1
          price: 10
      children:
        storage: *small_storage
        distribution: *normal_distribution
      config:
        unit_delay_order_penalty: 10
        unit_order_cost: 0

    - name: "Warehouse_001"
      definition_ref: "WarehouseFacility"
      skus:
        sku1:
          init_stock: 10
          price: 100
        sku2:
          init_stock: 10
          price: 100
        sku3:
          init_stock: 10
          price: 100
          has_consumer: True
      children:
        storage: *small_storage
        distribution: *normal_distribution
      config:
        unit_delay_order_penalty: 10
        unit_order_cost: 200

    - name: "Retailer_001"
      definition_ref: "RetailerFacility"
      skus:
        sku1:
          price: 300
          init_stock: 10
          sale_gamma: 10
          backlog_ratio: 0.1
          has_consumer: True
          has_seller: True
        sku3:
          price: 200
          init_stock: 10
          sale_gamma: 10
          backlog_ratio: 0.1
          has_consumer: True
          has_seller: True
        sku2:
          price: 100
          init_stock: 10
          sale_gamma: 10
          backlog_ratio: 0.1
          has_consumer: True
          has_seller: True
      children:
        storage: *small_storage
      config:
        unit_order_cost: 200

  topology:
    Warehouse_001:
      sku3:
        "Supplier_SKU3":
          "train":
            vlt: 7
            cost: 1
    Retailer_001:
      sku1:
        "Warehouse_001":
          "train":
            vlt: 7
            cost: 1
      sku2:
        "Warehouse_001":
          "train":
            vlt: 7
            cost: 1
      sku3:
        "Warehouse_001":
          "train":
            vlt: 7
            cost: 1

settings:
  pending_order_len: 4
